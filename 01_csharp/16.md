<h1>Tratamento de erros no C# - Exceptions</h1>



Componentes de software podem ter problemas durante a execu√ß√£o e gerar erros como:

- Terminar o programa;
- Retornar uma mensagem de erro indicando uma falha;
- Retornar e ignorar o problema;
- Chamar um m√©todo para tratar o erro, entre outras.

Os problemas mais comumente encontrados s√£o:

- Falha na aquisi√ß√£o de um recurso (new, open...);
- Tentativa de fazer algo imposs√≠vel (divis√£o por zero, √≠ndice de um array inv√°lido...);
- Outras condi√ß√µes inv√°lidas (lista vazia, overflow...).

Para contornar estes empecilhos, utilizamos o recurso chamado **Exce√ß√µes (Exceptions)**.

<br />

<h2>1. Exceptions</h2>



As **Exce√ß√µes** (Exceptions) s√£o uma indica√ß√£o de um problema que ocorre durante a execu√ß√£o de um programa, ou seja, s√£o eventos que interrompem o fluxo normal de processamento de uma classe causando um erro na aplica√ß√£o. 

Na Linguagem C#, √© poss√≠vel tratar as exce√ß√µes, que normalmente interromperiam a execu√ß√£o da aplica√ß√£o, de forma que o programa continue funcionando ou termine de forma elegante, tornando o c√≥digo muito mais robusto e confi√°vel.

As Exce√ß√µes na Linguagem C# s√£o Objetos criados a partir de Classes especiais, que s√£o ‚Äúdisparados‚Äù quando ocorrem condi√ß√µes excepcionais durante a execu√ß√£o do c√≥digo. 

<h3>1.1 Tipos de erros</h2>
Os erros que acontecem nas aplica√ß√µes C# est√£o classificados em 3 categorias:

1. **Erros de l√≥gica:** Esta categoria abrange erros na constru√ß√£o do Algoritmo. Este tipo de erro devem ser corrigidos pelo programador

	**Exemplos:** Limites do vetor ultrapassados, divis√£o por zero, entre outros;

2. **Erros devido a condi√ß√µes do ambiente de execu√ß√£o:** Esta categoria abrange erros na infraestrutura onde a aplica√ß√£o est√° sendo executada. Este tipo de erro foge do controle da pessoa desenvolvedora, mas podem ser contornados em tempo de execu√ß√£o;

	**Exemplos:** arquivo n√£o encontrado, rede fora do ar, entre outros;

3. **Erros graves:** S√£o erros que simplesmente travam o sistema e n√£o h√° nada o que fazer. Este tipo de erro foge do controle da pessoa desenvolvedora e n√£o podem ser contornados;

	**Exemplos:** falta de mem√≥ria, erro interno do C#, entre outros.

As Exce√ß√µes tem como foco principal tratar os erros do tipo 1, ou seja, erros de l√≥gica, como veremos no exemplo abaixo:

<br />

<img src="https://i.imgur.com/bm8Jxxm.png" title="source: imgur.com" width="4%"/>**Exemplo 01 - Divis√£o entre 2 n√∫meros inteiros:** 

```c#
using System.Runtime.ConstrainedExecution;

namespace exceptions_01
{
    internal class Program
    {
        static void Main(string[] args)
        {
            int dividendo = 0;
            int divisor = 0;

            Console.WriteLine("Digite o Dividendo: ");
            dividendo = Convert.ToInt32(Console.ReadLine());

            Console.WriteLine("Digite o Divisor: ");
            divisor = Convert.ToInt32(Console.ReadLine());

            Dividir(dividendo, divisor);
        }

        public static void Dividir(int dividendo, int divisor)
        {
            Console.WriteLine("Divis√£o = " + (dividendo / divisor));
        }

    }
}
```

O c√≥digo acima, √© um programa simples, que recebe 2 n√∫meros inteiros e chama um m√©todo chamado dividir(), que far√° a divis√£o entre estes 2 n√∫mero. Execute o c√≥digo acima e digite os valores 10 e 0.

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

<div align="center"><img src="https://i.imgur.com/nW6eFDq.png" title="source: imgur.com" /></div>

Na imagem acima, vemos que foi disparada uma exce√ß√£o: **DivideByZeroException** (indicado por uma seta verde), informando que aconteceu algum erro em uma opera√ß√£o aritm√©tica (c√°lculo matem√°tico) e na sequ√™ncia o programa √© finalizado sem dar a oportunidade de contornar o erro. No exemplo acima, a exce√ß√£o indica que n√£o √© poss√≠vel efetuar a divis√£o de um n√∫mero por zero.

Execute o c√≥digo novamente e experimente inserir uma string ao inv√©s de um numero no segundo valor. 

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

<div align="center"><img src="https://i.imgur.com/W0VruvS.png" title="source: imgur.com" /></div>

Na imagem acima, vemos que desta vez foi disparada uma outra exce√ß√£o: **FormatException** (indicado por uma seta verde), informando que aconteceu algum erro na entrada de dados da aplica√ß√£o e na sequ√™ncia o programa √© finalizado sem dar a oportunidade de contornar o erro. No exemplo acima, a exce√ß√£o indica que o M√©todo de convers√£o  tentou converter a string em n√∫mero inteiro conseguiu, ou seja, estava aguardando por um n√∫mero inteiro e recebeu uma string.

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="" target="_blank"><b>C√≥digo fonte: Exemplo 01</b></a></div>

<br />

Quando uma exce√ß√£o √© lan√ßada sem nenhum tipo de tratamento, ela interrompe o **fluxo normal** do programa, como vimos nos 2 exemplos acima. Se o m√©todo onde o erro aconteceu n√£o capturar a exce√ß√£o, ela ser√° **propagada** para o m√©todo que chamar esse m√©todo e assim por diante. Se **ningu√©m** capturar a exce√ß√£o, ela causar√° o t√©rmino da aplica√ß√£o. Agora se em algum lugar ela for capturada, **o controle da aplica√ß√£o pode ser recuperado**.

Um bom **Sistema de Tratamento de Exce√ß√µes** procura sempre atender a 3 princ√≠pios fundamentais: 

- Se antecipar aos problemas (uma das tarefas da pessoa desenvolvedora);
- Reverter situa√ß√µes de erro que podem ser revertidas;
- Buscar a **Solu√ß√£o ideal** para o tratamento de problemas de forma isolada do c√≥digo principal.

Com o tratamento de exce√ß√µes, o programa captura e trata o erro, isto √©, lida com a exce√ß√£o. Para capturar e lidar com as exce√ß√µes o C# utiliza a estrutura **try-catch-finally**.

<br />

<h2>2. Estrutura try-catch-finally</h2>

A estrutura **try-catch-finally** √© utilizada pelo C# para capturar e tratar um erro ou exce√ß√£o. Ela √© composta por 3 estruturas b√°sicas:

- **try:** √© usada para indicar um bloco de c√≥digo que possa lan√ßar (throw) uma exce√ß√£o. Caso ocorra uma exce√ß√£o em algum ponto, o restante do c√≥digo contido no bloco <em>try</em> n√£o ser√° executado. O bloco <em>try</em> n√£o pode ser declarado sozinho, portanto, precisa estar seguido de um ou v√°rios blocos <em>catch</em> e/ou de um bloco <em>finally</em>.
- **catch:** serve para manipular as exce√ß√µes, ou seja, tratar o erro. Esse bloco ser√° executado somente se o bloco <em>try</em> apresentar alguma exce√ß√£o. Numa estrutura try-catch-finally voc√™ pode criar um ou mais blocos <em>catch</em>, por√©m, ser√° executado apenas o primeiro bloco que identificar a exce√ß√£o.
- **finally:** √© um bloco opcional, mas caso seja constru√≠do, quase sempre ser√° executado, a menos que seja for√ßada sua parada, por exemplo, com um System.exit(0), no catch (finalizar a aplica√ß√£o independente do que estiver sendo processado). Dentro do bloco finally, poder√° conter outros blocos try-catch, bem como outro <em>finally</em>. Geralmente utilizamos o bloco finally quando precisamos executar algum c√≥digo independente se ocorrer a exception ou n√£o.

Na imagem abaixo, vemos a sintaxe da estrutura try-catch-finally dentro do c√≥digo C#:

<div align="center"><img src="https://i.imgur.com/Uwvqs3q.png" title="source: imgur.com" /></div>

O **Bloco try** cont√©m o c√≥digo que pode lan√ßar (throw) uma exce√ß√£o. Ele consiste na palavra ‚Äì chave try seguida por um bloco de c√≥digo entre chaves.

O **Bloco Catch** captura e trata uma exce√ß√£o. Ele come√ßa com a palavra-chave catch. Dentro dos par√™nteses deve ser inserido o par√¢metro de exce√ß√£o, que identifica o tipo da exce√ß√£o, ou seja, um Objeto da classe ou subclasse da poss√≠vel exce√ß√£o. O bloco de c√≥digo entre as chaves ser√° executado quando uma exce√ß√£o do tipo indicado no par√¢metro ocorre, ou seja, o que fazer em caso de erro.

O **Bloco Finally** se for constru√≠do, quase sempre ser√° executado. Geralmente ele cont√©m c√≥digo de libera√ß√£o de recursos do sistema. **Exemplo:** finalizar a conex√£o com uma Banco de dados

Na imagem abaixo, vemos a sintaxe da estrutura try-catch-finally dentro do c√≥digo C#:

<div align="center"><img src="https://i.imgur.com/hORZemU.png" title="source: imgur.com" /></div>

<br />

<h3>2.1 O comando de Sa√≠da Console.Error.WriteLine()</h3>

O comando de Sa√≠da **Console.Error.WriteLine()** funciona da mesma forma que o comando de Sa√≠da Console.WriteLine(). A principal diferen√ßa √© que este comando √© usado principalmente para exibir os erros de exce√ß√£o no console. 

Vamos implementar o tratamento de exce√ß√µes no **Exemplo 01**:

<br />

<img src="https://i.imgur.com/bm8Jxxm.png" title="source: imgur.com" width="4%"/>**Exemplo 02 - Divis√£o entre 2 n√∫meros inteiros com tratamento de exce√ß√µes:** 

```c#
using System.Runtime.ConstrainedExecution;

namespace exceptions_02
{
    internal class Program
    {
        static void Main(string[] args)
        {
            int dividendo = 0;
            int divisor = 0;
            bool loop = true;

            do
            {

                try
                {
                    Console.WriteLine("Digite o Dividendo: ");
                    dividendo = Convert.ToInt32(Console.ReadLine());

                    Console.WriteLine("Digite o Divisor: ");
                    divisor = Convert.ToInt32(Console.ReadLine());

                    Dividir(dividendo, divisor);

                    loop = false;

                }
                catch (FormatException e)
                {
                    Console.Error.WriteLine("\nExce√ß√£o: " + e);
                    Console.WriteLine("\nDigite valores inteiros!");
                }
                catch (DivideByZeroException e)
                {
                    Console.Error.WriteLine("\nExce√ß√£o: " + e);
                    Console.WriteLine("\nDigite Numeros inteiros positivos!");
                }
                finally
                {
                    Console.WriteLine("\nSempre serei executada!\n");
                }

            } while (loop);
        }

        public static void Dividir(int dividendo, int divisor)
        {
            Console.WriteLine("Divis√£o = " + (dividendo / divisor));
        }
    }
}
```

Execute o c√≥digo acima e digite os valores 10 e 0, novamente.

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

<div align="center"><img src="https://i.imgur.com/hBAN7qK.png" title="source: imgur.com" /></div>

<br />

Observe na imagem acima que a exce√ß√£o: **DivideByZeroException**  (indicado pela seta rosa), foi disparada, mas desta vez foi exibida uma mensagem personalizada de alerta sobre o erro (indicada pela seta amarela). Como implementamos o bloco **finally**, tamb√©m ser√° exibida a mensagem criada dentro do bloco (indicada pela seta azul) e o programa ser√° reiniciado (seta verde), solicitando uma nova entrada de dados. 

<br />

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **IMPORTANTE:** *Para ocultar a Exce√ß√£o que foi disparada (linha indicada pela seta rosa), e exibir apenas a mensagem personalizada, basta n√£o exibir no console o conte√∫do da vari√°vel e, que armazena a Exce√ß√£o capturada.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

Experimente inserir uma string ao inv√©s de um numero no segundo valor. 

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

<div align="center"><img src="https://i.imgur.com/jMXNLnf.png" title="source: imgur.com" /></div>

Observe na imagem acima que a exce√ß√£o: **FormatException**  (indicado pela seta rosa), foi disparada, mas desta vez foi exibida uma mensagem personalizada de alerta sobre o erro (indicada pela seta amarela). Como implementamos o bloco **finally**, tamb√©m ser√° exibida a mensagem criada dentro do bloco (indicada pela seta azul) e o programa ser√° reiniciado (seta verde), solicitando uma nova entrada de dados. 

Experimente inserir os valores 10 e 2:

<div align="center"><img src="https://i.imgur.com/zwPcMKQ.png" title="source: imgur.com" /></div>

Observe na imagem acima que nenhuma exce√ß√£o foi disparada e o c√°lculo da divis√£o foi efetuado com sucesso. Entretanto, como implementamos o comando **finally**, a mensagem (indicada pela seta verde) continuar√° sendo exibida, mesmo que nenhuma exce√ß√£o seja disparada.

<br />

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="25px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/csharp/fundamentals/exceptions/" target="_blank"><b>Documenta√ß√£o: Exceptions</b></a></div>

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="25px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/csharp/language-reference/statements/exception-handling-statements#the-try-statement" target="_blank"><b>Documenta√ß√£o: try catch finally</b></a></div>

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="25px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/api/system.dividebyzeroexception?view=net-7.0" target="_blank"><b>Documenta√ß√£o: DivideByZeroException</b></a></div>

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="25px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/api/system.formatexception?view=net-7.0" target="_blank"><b>Documenta√ß√£o: FormatException</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="" target="_blank"><b>C√≥digo fonte: Exemplo 02</b></a></div>

<br />

<h2>3. A Classe Exceptions</h2>

Como vimos no exemplo anterior, foram tratadas 2 Exce√ß√µes dentro da aplica√ß√£o: **DivideByZeroException** **FormatException**. De onde vieram estas Exce√ß√µes? a resposta √© a Classe **Exceptions**, que √© uma Sub-Classe da Classe **System**. Veja na imagem abaixo, a hierarquia da Classe Exception:

<div align="center"><img src="https://i.imgur.com/Lrv1qbY.png" title="source: imgur.com" /></div>

- **System:** S√£o as classes que lan√ßam exce√ß√µes comuns do sistema. **Exemplo:** tentar dividir um n√∫mero por zero. 
- **Data Exception**: S√£o exce√ß√µes que indicam erros de Banco de dados. **Exemplo:** tentar duplicar a Chave Prim√°ria. 
- **IOException**: S√£o exce√ß√µes que indicam erros de entrada/sa√≠da por falha ou interrup√ß√£o. **Exemplo:** interrup√ß√£o ou falha na leitura de um arquivo em disco.
- **Application Exception**: S√£o exce√ß√µes criadas pela pessoa desenvolvedora para responder a um erro espec√≠fico do sistema.

<h3>3.1. Exce√ß√µes Integradas</h3>

As exce√ß√µes integradas s√£o as exce√ß√µes dispon√≠veis nas bibliotecas C#. Essas exce√ß√µes s√£o adequadas para explicar certas situa√ß√µes de erro. Na tabela abaixo, listamos as Exce√ß√µes mais tratadas:

| Tipo de exce√ß√£o                                              | Descri√ß√£o                                                    |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| [Exception](https://learn.microsoft.com/pt-br/dotnet/api/system.exception) | A classe base para todas as exce√ß√µes.                        |
| [IndexOutOfRangeException](https://learn.microsoft.com/pt-br/dotnet/api/system.indexoutofrangeexception) | Gerada pelo runtime somente quando uma matriz √© indexada incorretamente. |
| [NullReferenceException](https://learn.microsoft.com/pt-br/dotnet/api/system.nullreferenceexception) | Gerada pelo runtime somente quando um objeto nulo √© referenciado. |
| [InvalidOperationException](https://learn.microsoft.com/pt-br/dotnet/api/system.invalidoperationexception) | Gerada por m√©todos quando em um estado inv√°lido.             |
| [ArgumentException](https://learn.microsoft.com/pt-br/dotnet/api/system.argumentexception) | A classe base para todas as exce√ß√µes de argumento.           |
| [ArgumentNullException](https://learn.microsoft.com/pt-br/dotnet/api/system.argumentnullexception) | Gerada por m√©todos que n√£o permitem que um argumento seja nulo. |
| [ArgumentOutOfRangeException](https://learn.microsoft.com/pt-br/dotnet/api/system.argumentoutofrangeexception) | Gerada por m√©todos que verificam se os argumentos est√£o em um determinado intervalo. |
| [ArithmeticException](https://learn.microsoft.com/pt-br/dotnet/api/system.arithmeticexception) | Uma classe base para exce√ß√µes que ocorrem durante opera√ß√µes aritm√©ticas. |
| [ArrayTypeMismatchException](https://learn.microsoft.com/pt-br/dotnet/api/system.arraytypemismatchexception) | Gerada quando uma matriz n√£o pode armazenar determinado elemento  porque o tipo real do elemento √© incompat√≠vel com o tipo real da matriz. |
| [DivideByZeroException](https://learn.microsoft.com/pt-br/dotnet/api/system.dividebyzeroexception) | Lan√ßada quando √© feita uma tentativa de dividir um valor inteiro por zero. |
| [IndexOutOfRangeException](https://learn.microsoft.com/pt-br/dotnet/api/system.indexoutofrangeexception) | Lan√ßada quando √© feita uma tentativa de indexar uma matriz quando o √≠ndice √© menor que zero ou fora dos limites da matriz. |
| [InvalidCastException](https://learn.microsoft.com/pt-br/dotnet/api/system.invalidcastexception) | Gerada quando uma convers√£o expl√≠cita de um tipo base para uma interface ou um tipo derivado falha em tempo de execu√ß√£o. |
| [NullReferenceException](https://learn.microsoft.com/pt-br/dotnet/api/system.nullreferenceexception) | Gerada quando h√° uma tentativa de fazer refer√™ncia a um objeto cujo valor √© [null](https://learn.microsoft.com/pt-br/dotnet/csharp/language-reference/keywords/null). |
| [OutOfMemoryException](https://learn.microsoft.com/pt-br/dotnet/api/system.outofmemoryexception) | Lan√ßada quando uma tentativa de alocar mem√≥ria usando o operador [new](https://learn.microsoft.com/pt-br/dotnet/csharp/language-reference/operators/new-operator) falha. Essa exce√ß√£o indica que a mem√≥ria dispon√≠vel para o Common Language Runtime est√° esgotada. |
| [OverflowException](https://learn.microsoft.com/pt-br/dotnet/api/system.overflowexception) | Lan√ßada quando uma opera√ß√£o aritm√©tica em um contexto `checked` estoura. |
| [StackOverflowException](https://learn.microsoft.com/pt-br/dotnet/api/system.stackoverflowexception) | Lan√ßada quando a pilha de execu√ß√£o acaba tendo muitas chamadas de  m√©todo pendentes, normalmente indica uma recurs√£o muito profunda ou  infinita. |
| [TypeInitializationException](https://learn.microsoft.com/pt-br/dotnet/api/system.typeinitializationexception) | Lan√ßada quando um construtor est√°tico lan√ßa uma exce√ß√£o e n√£o h√° nenhuma cl√°usula `catch` compat√≠vel para captur√°-la. |

<br />

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="30px"/> <a href="https://www.completecsharptutorial.com/basic/complete-system-exception.php" target="_blank"><b>Artigo: Lista Completa de Exce√ß√µes da Linguagem C#</b></a></div>

<br />


<h2>4. Throw</h2>

A **Cl√°usula throw lan√ßa uma exce√ß√£o em qualquer ponto do c√≥digo**, mas n√£o exige que ela seja tratada pela Classe que est√° chamando o M√©todo. Ela transfere o controle do fluxo para os m√©todos chamadores. A cl√°usula throw permite lan√ßar exce√ß√µes verificadas ou n√£o verificadas.

A palavra-chave throw √© usada principalmente para lan√ßar exce√ß√µes personalizadas, ou seja, uma Classe de Exce√ß√£o criada pela pessoa desenvolvedora, para ser lan√ßada em um erro espec√≠fico, quando o C# n√£o possui um tipo de Exce√ß√£o Integrada adequado para o erro. Veja o exemplo abaixo:

<br />

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="30px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/csharp/language-reference/statements/exception-handling-statements#the-throw-statement" target="_blank"><b>Documenta√ß√£o: throw</b></a></div>

<br />

<img src="https://i.imgur.com/bm8Jxxm.png" title="source: imgur.com" width="4%"/>**Exemplo 03 - Cl√°usula Throw - Vers√£o 01:** 

No exemplo abaixo, vamos construir uma aplica√ß√£o para checar se uma pessoa est√° apta a dirigir:

```c#
namespace exceptions_03
{
    internal class Program
    {
        static void Main(string[] args)
        {
            int idade;

            Console.WriteLine("\nDigite uma idade: ");
            idade = Convert.ToInt32(Console.ReadLine());

            ValidarIdade(idade);
        }

        public static void ValidarIdade(int idade)
        {

            if (idade < 18)
                throw new ArithmeticException("A Pessoa n√£o pode dirigir!!");
            else
                Console.WriteLine("A Pessoa pode dirigir!!");

        }
    }
}
```

Execute o c√≥digo acima e digite um valor menor do que 18 anos. O resultado voc√™ confere abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```bash
Digite uma idade:
12
Unhandled exception. System.ArithmeticException: A Pessoa n√£o pode dirigir!!
   at exceptions_03.Program.ValidarIdade(Int32 idade) in C:\Users\rafae\OneDrive\√Årea de Trabalho\csharp\cookbook\16_exceptions\exceptions_03\Program.cs:line 19
   at exceptions_03.Program.Main(String[] args) in C:\Users\rafae\OneDrive\√Årea de Trabalho\csharp\cookbook\16_exceptions\exceptions_03\Program.cs:line 12
```

<br />

Observe que a exce√ß√£o: **ArithmeticException**  foi disparada dentro do M√©todo **ValidarIdade()**, exibindo a mensagem padr√£o do erro e o programa foi finalizado imediatamente.

Ao executar a instru√ß√£o **throw**, o programa tenta encontrar algum bloco **try**, que possua instru√ß√£o **catch** correspondente ao tipo de exce√ß√£o que foi lan√ßada. Se encontrar uma correspond√™ncia, o controle ser√° transferido para essa instru√ß√£o, caso contr√°rio o programa ser√° finalizado. Vamos atualizar este c√≥digo inserindo um Bloco **try...catch**.

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/exemplos_java/tree/main/exceptions/exceptions_throw_v1" target="_blank"><b>C√≥digo fonte: Exemplo 03</b></a></div>

<br />

<img src="https://i.imgur.com/bm8Jxxm.png" title="source: imgur.com" width="4%"/>**Exemplo 04 - Cl√°usula Throw - Vers√£o 2:** 

```c#
namespace exceptions_04
{
    internal class Program
    {
        static void Main(string[] args)
        {
            int idade;
            bool loop = true;

            do
            {

                try
                {

                    Console.WriteLine("\nDigite uma idade: ");
                    idade = Convert.ToInt32(Console.ReadLine());

                    ValidarIdade(idade);

                    loop = false;

                }
                catch (ArithmeticException)
                {
                    Console.WriteLine("\nDigite um n√∫mero inteiro maior ou igual a 18!");
                }

            } while (loop);
        }

        public static void ValidarIdade(int idade)
        {

            if (idade < 18)
                throw new ArithmeticException("A Pessoa n√£o pode dirigir!!");
            else
                Console.WriteLine("A Pessoa pode dirigir!!");

        }
    }
}
```

Execute o c√≥digo acima e digite um valor menor do que 18 anos. O resultado voc√™ confere abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```bash
Digite uma idade: 
12

Digite um n√∫mero inteiro maior ou igual a 18!

Digite uma idade:_ 
```

<br />

Observe que a exce√ß√£o: **ArithmeticException** foi disparada dentro do M√©todo **ValidarIdade()**, mas desta vez foi exibida a mensagem personalizada: *"Digite um n√∫mero inteiro maior ou igual a 18!"*. Al√©m disso, o controle sobre o que fazer com o erro, foi transferido para o Bloco **try...catch**, que solicita ao usu√°rio que digite uma nova idade maior ou igual a 18. Como foi implementado um La√ßo de repeti√ß√£o **do...while**, este processo se repetir√° at√© que o usu√°rio digite uma idade maior ou igual a 18.

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="" target="_blank"><b>C√≥digo fonte: Exemplo 04</b></a></div>

<br />

<h2>4. Exce√ß√µes definidas pelo usu√°rio</h2>



Exce√ß√µes definidas pelo usu√°rio s√£o aquelas exce√ß√µes que n√£o s√£o definidas pela linguagem de programa√ß√£o. Em C#, podemos criar nossas pr√≥prias exce√ß√µes personalizadas para tratar erros espec√≠ficos da aplica√ß√£o.

As exce√ß√µes C# s√£o definidas como classes, assim como qualquer outro objeto C#. Todas as exce√ß√µes s√£o herdadas de uma classe base System.Exception. H√° muitas exce√ß√µes comuns que voc√™ pode usar em seu pr√≥prio c√≥digo, como vimos anteriormente.

Criar suas pr√≥prias exce√ß√µes personalizadas em C# √© √∫til apenas quando voc√™  for capturar um tipo espec√≠fico de exce√ß√£o e manipul√°-lo de maneira diferente .Veja o exemplo abaixo:

<br />

<img src="https://i.imgur.com/bm8Jxxm.png" title="source: imgur.com" width="4%"/>**Exemplo 05 - Exce√ß√£o personalizada** 

1. Criar um novo projeto chamado **excecaosimples**;
2. Inserir a **Classe ExcecaoSimples** (Exce√ß√£o personalizada), que ser√° uma Classe do tipo Exception, criada pela pessoa desenvolvedora;
3. Inserir o c√≥digo abaixo na Classe **ExcecaoSimples**:

```c#
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace excecao_simples
{
    public class ExcecaoSimples : Exception
    {
        public ExcecaoSimples(string message) : base(message)
        {
            Console.WriteLine("Exce√ß√£o definida pelo Usu√°rio!");
        }
    }
}

```

Observe que a Classe **ExcecaoSimples** foi definida como uma heran√ßa da Classe **Exception**.

> **Heran√ßa** √© um tipo de Relacionamento entre Classes no C# e uma das maiores vantagens da Programa√ß√£o Orientada a Objetos, permitindo que o c√≥digo seja reutilizado. Em C#, √© poss√≠vel herdar **atributos** e **comportamentos** (**m√©todos**) de uma classe para outra. A palavra extends inserida na assinatura da Classe, indica que a Classe est√° herdando uma outra Classe.

Na sequ√™ncia, foi criado 1 M√©todo Construtor, herdado da Classe Exception com o par√¢metro **message**, que permite personalizar a mensagem de erro. A Classe Exception possui outros M√©todos Construtores com outros par√¢metros, que podem ser utilizados conforme a sua necessidade.

<br />

<div align="left"><img src="https://i.imgur.com/DNV9Rxu.png" title="source: imgur.com" width="30px"/> <a href="https://learn.microsoft.com/pt-br/dotnet/standard/exceptions/how-to-create-localized-exception-messages" target="_blank"><b>Documenta√ß√£o: Exce√ß√µes definidas pelo usu√°rio</b></a></div>

<br />


Na sequ√™ncia, vamos testar a nossa Classe **ExcecaoSimples** inserindo o c√≥digo abaixo na **Classe Program**:

```c#
namespace excecao_simples
{
    internal class Program
    {
        static void Main(string[] args)
        {
            string[] nomes = { "Jo√£o", "Maria", "Pedro", "Manuela" };

            try
            {
                for (int i = 0; i < nomes.Length; i++)
                {
                    Console.WriteLine(nomes[i]);
                }
            }
            catch (IndexOutOfRangeException e)
            {
                Console.Error.WriteLine("\nExce√ß√£o: " + e);
                Console.WriteLine("\nPosi√ß√£o Inv√°lida");
            }

            throw new ExcecaoSimples("Exce√ß√£o Simples Lan√ßada!");

        }
    }
}
```

Observe que foi inserido no final do c√≥digo a linha **throw new ExcecaoSimples("Exce√ß√£o Simples!")**. Nesta linha, estamos lan√ßando a exce√ß√£o criada na **Classe ExcecaoSimples**, independente ter acontecido um erro, ou seja, ela ser√° lan√ßada de qualquer forma. Veja o resultado no console abaixo:

<img src="https://i.imgur.com/V2ReOnx.png" title="source: imgur.com" width="3%"/>**Resultado do Algoritmo:**

```bash
Jo√£o
Maria
Pedro
Manuela
Exce√ß√£o definida pelo Usu√°rio!
Unhandled exception. excecao_simples.ExcecaoSimples: Exce√ß√£o Simples Lan√ßada!
   at excecao_simples.Program.Main(String[] args) in C:\Users\rafae\OneDrive\√Årea de Trabalho\csharp\cookbook\16_exceptions\excecao_simples\Program.cs:line 22
```

Observe que mesmo a Exception **IndexOutOfRangeException** n√£o sendo disparada, a Exception Exce√ß√£oSimples foi disparada. Este recurso √© √∫til quando queremos lan√ßar uma exce√ß√£o em um condicional, por exemplo, caso uma condi√ß√£o n√£o seja satisfeita.

<br />

<div align="left"><img src="https://i.imgur.com/JACNZiR.png" title="source: imgur.com" width="25px"/> <a href="" target="_blank"><b>C√≥digo fonte: Exemplo 05</b></a></div>

<br />

<h2>5. Por que devemos tratar as Exce√ß√µes?</h2>

Quando uma Exce√ß√£o √© tratada, estamos oferecendo alguma forma alternativa para continuar a execu√ß√£o do programa sem que ele seja finalizado devido ao erro. O tratamento de exce√ß√µes desempenha um papel importante no desenvolvimento de uma aplica√ß√£o concisa, limpa, leg√≠vel e de f√°cil manuten√ß√£o. 

<br />

------

## üîë**Pontos chave:**

1. **Exce√ß√µes** em C# s√£o classes especiais utilizadas para manipular erros que podem surgir durante a execu√ß√£o.
2. *O* **bloco try/catch/finally** permite capturar exce√ß√µes que podem ocorrer quando uma parcela de c√≥digo ou fun√ß√£o √© executada.
3. A **cl√°usula throw lan√ßa uma exce√ß√£o em qualquer ponto do c√≥digo**, mas n√£o exige que ela seja tratada por seus chamadores.
5. Voc√™ tamb√©m pode criar e lan√ßar exce√ß√µes personalizadas.

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
